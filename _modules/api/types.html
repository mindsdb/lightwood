

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>api.types &mdash; lightwood 25.3.3.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />

  
      <script src="../../_static/jquery.js"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
      <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
      <script src="../../_static/doctools.js"></script>
      <script src="../../_static/sphinx_highlight.js"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/mindsdblogo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Tutorials</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">API</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Data</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../encoder.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Encoders</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mixer.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Mixers</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ensemble.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Ensemble</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analysis.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Analysis</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../helpers.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Helpers</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lightwood_philosophy.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Lightwood</span> <span class="pre">Philosophy</span></code></a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">lightwood</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">api.types</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for api.types</h1><div class="highlight"><pre>
<span></span><span class="c1"># TODO: type hint the returns</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Union</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">type_infer.dtype</span><span class="w"> </span><span class="kn">import</span> <span class="n">dtype</span>

<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">):</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TypedDict</span>
<span class="k">else</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">typing_extensions</span><span class="w"> </span><span class="kn">import</span> <span class="n">TypedDict</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">lightwood.helpers.log</span><span class="w"> </span><span class="kn">import</span> <span class="n">log</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses_json</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass_json</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses_json.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">_asdict</span><span class="p">,</span> <span class="n">Json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>


<span class="c1"># See: https://www.python.org/dev/peps/pep-0589/ for how this works</span>
<span class="c1"># Not very intuitive but very powerful abstraction, might be useful in other places (@TODO)</span>
<div class="viewcode-block" id="Module"><a class="viewcode-back" href="../../api/types.html#api.types.Module">[docs]</a><span class="k">class</span><span class="w"> </span><span class="nc">Module</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Modules are the blocks of code that end up being called from the JSON AI, representing either object instantiations or function calls.</span>

<span class="sd">    :param module: Name of the module (function or class name)</span>
<span class="sd">    :param args: Argument to pass to the function or constructor</span>
<span class="sd">    &quot;&quot;&quot;</span> <span class="c1"># noqa</span>
    <span class="n">module</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">args</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span></div>


<div class="viewcode-block" id="TimeseriesSettings"><a class="viewcode-back" href="../../api/types.html#api.types.TimeseriesSettings">[docs]</a><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TimeseriesSettings</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    For time-series specific problems, more specific treatment of the data is necessary. The following attributes \</span>
<span class="sd">        enable time-series tasks to be carried out properly.</span>

<span class="sd">    :param is_timeseries: Whether the input data should be treated as time series; if true, this flag is checked in \</span>
<span class="sd">        subsequent internal steps to ensure processing is appropriate for time-series data.</span>
<span class="sd">    :param order_by: Column by which the data should be ordered.</span>
<span class="sd">    :param group_by: Optional list of columns by which the data should be grouped. Each different combination of values\</span>
<span class="sd">         for these columns will yield a different series.</span>
<span class="sd">    :param window: The temporal horizon (number of rows) that a model intakes to &quot;look back&quot; into when making a\</span>
<span class="sd">         prediction, after the rows are ordered by the order_by column and split into groups if applicable.</span>
<span class="sd">    :param horizon: The number of points in the future that predictions should be made for, defaults to 1. Once \</span>
<span class="sd">        trained, the model will be able to predict up to this many points into the future.</span>
<span class="sd">    :param historical_columns: The temporal dynamics of these columns will be used as additional context to train the \</span>
<span class="sd">        time series predictor. Note that a non-historical column shall still be used to forecast, but without \</span>
<span class="sd">            considering their change through time.</span>
<span class="sd">    :param target_type: Automatically inferred dtype of the target (e.g. `dtype.integer`, `dtype.float`).</span>
<span class="sd">    :param use_previous_target: Use the previous values of the target column to generate predictions. Defaults to True.</span>
<span class="sd">    :param allow_incomplete_history: whether predictions can be made for rows with incomplete historical context (i.e. less than `window` rows have been observed for the datetime that has to be forecasted).</span>
<span class="sd">    :param eval_incomplete: whether to consider predictions with incomplete history or target information when evaluating mixer accuracy with the validation dataset.</span>
<span class="sd">    :param interval_periods: tuple of tuples with user-provided period lengths for time intervals. Default values will be added for intervals left unspecified. For interval options, check the `timeseries_analyzer.detect_period()` method documentation. e.g.: ((&#39;daily&#39;, 7),).</span>
<span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># noqa</span>

    <span class="n">is_timeseries</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">order_by</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">window</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">group_by</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">use_previous_target</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">horizon</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">historical_columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">target_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;&quot;</span>  <span class="c1"># @TODO: is the current setter (outside of initialization) a sane option?</span>
        <span class="c1"># @TODO: George: No, I don&#39;t think it is, we need to pass this some other way</span>
    <span class="p">)</span>
    <span class="n">allow_incomplete_history</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">eval_incomplete</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">interval_periods</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">()</span>

<div class="viewcode-block" id="TimeseriesSettings.from_dict"><a class="viewcode-back" href="../../api/types.html#api.types.TimeseriesSettings.from_dict">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_dict</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">Dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a TimeseriesSettings object from python dictionary specifications.</span>

<span class="sd">        :param: obj: A python dictionary with the necessary representation for time-series. The only mandatory columns are ``order_by`` and ``window``.</span>

<span class="sd">        :returns: A populated ``TimeseriesSettings`` object.</span>
<span class="sd">        &quot;&quot;&quot;</span> <span class="c1"># noqa</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">mandatory_setting</span><span class="p">,</span> <span class="n">etype</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="s2">&quot;order_by&quot;</span><span class="p">,</span> <span class="s2">&quot;window&quot;</span><span class="p">],</span> <span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]):</span>
                <span class="k">if</span> <span class="n">mandatory_setting</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
                    <span class="n">err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Missing mandatory timeseries setting: </span><span class="si">{</span><span class="n">mandatory_setting</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">obj</span><span class="p">[</span><span class="n">mandatory_setting</span><span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="n">mandatory_setting</span><span class="p">],</span> <span class="n">etype</span><span class="p">):</span>
                    <span class="n">err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Wrong type for mandatory timeseries setting &#39;</span><span class="si">{</span><span class="n">mandatory_setting</span><span class="si">}</span><span class="s2">&#39;: found &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="n">mandatory_setting</span><span class="p">])</span><span class="si">}</span><span class="s2">&#39;, expected &#39;</span><span class="si">{</span><span class="n">etype</span><span class="si">}</span><span class="s2">&#39;&quot;</span>  <span class="c1"># noqa</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

            <span class="n">timeseries_settings</span> <span class="o">=</span> <span class="n">TimeseriesSettings</span><span class="p">(</span>
                <span class="n">is_timeseries</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">order_by</span><span class="o">=</span><span class="n">obj</span><span class="p">[</span><span class="s2">&quot;order_by&quot;</span><span class="p">],</span>
                <span class="n">window</span><span class="o">=</span><span class="n">obj</span><span class="p">[</span><span class="s2">&quot;window&quot;</span><span class="p">],</span>
                <span class="n">use_previous_target</span><span class="o">=</span><span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_previous_target&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
                <span class="n">historical_columns</span><span class="o">=</span><span class="p">[],</span>
                <span class="n">horizon</span><span class="o">=</span><span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;horizon&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="n">allow_incomplete_history</span><span class="o">=</span><span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;allow_incomplete_history&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
                <span class="n">eval_incomplete</span><span class="o">=</span><span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;eval_incomplete&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
                <span class="n">interval_periods</span><span class="o">=</span><span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;interval_periods&#39;</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">()))</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">setting</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
                <span class="n">timeseries_settings</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">setting</span><span class="p">,</span> <span class="n">obj</span><span class="p">[</span><span class="n">setting</span><span class="p">])</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">timeseries_settings</span> <span class="o">=</span> <span class="n">TimeseriesSettings</span><span class="p">(</span><span class="n">is_timeseries</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">timeseries_settings</span></div>

<div class="viewcode-block" id="TimeseriesSettings.from_json"><a class="viewcode-back" href="../../api/types.html#api.types.TimeseriesSettings.from_json">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_json</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a TimeseriesSettings object from JSON specifications via python dictionary.</span>

<span class="sd">        :param: data: JSON-config file with necessary Time-series specifications</span>

<span class="sd">        :returns: A populated ``TimeseriesSettings`` object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">TimeseriesSettings</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">))</span></div>

<div class="viewcode-block" id="TimeseriesSettings.to_dict"><a class="viewcode-back" href="../../api/types.html#api.types.TimeseriesSettings.to_dict">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encode_json</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Json</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a dictionary from ``TimeseriesSettings`` object</span>

<span class="sd">        :returns: A python dictionary containing the ``TimeSeriesSettings`` specifications.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_asdict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encode_json</span><span class="o">=</span><span class="n">encode_json</span><span class="p">)</span></div>

<div class="viewcode-block" id="TimeseriesSettings.to_json"><a class="viewcode-back" href="../../api/types.html#api.types.TimeseriesSettings.to_json">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Json</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates JSON config from TimeseriesSettings object</span>
<span class="sd">        :returns: The JSON config syntax containing the ``TimeSeriesSettings`` specifications.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span></div></div>


<div class="viewcode-block" id="ProblemDefinition"><a class="viewcode-back" href="../../api/types.html#api.types.ProblemDefinition">[docs]</a><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ProblemDefinition</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The ``ProblemDefinition`` object indicates details on how the models that predict the target are prepared. \</span>
<span class="sd">        The only required specification from a user is the ``target``, which indicates the column within the input \</span>
<span class="sd">        data that the user is trying to predict. Within the ``ProblemDefinition``, the user can specify aspects \</span>
<span class="sd">        about how long the feature-engineering preparation may take, and nuances about training the models.</span>

<span class="sd">    :param target: The name of the target column; this is the column that will be used as the goal of the prediction.</span>
<span class="sd">    :param pct_invalid: Number of data points maximally tolerated as invalid/missing/unknown. \</span>
<span class="sd">        If the data cleaning process exceeds this number, no subsequent steps will be taken.</span>
<span class="sd">    :param unbias_target: all classes are automatically weighted inverse to how often they occur</span>
<span class="sd">    :param seconds_per_mixer: Number of seconds maximum to spend PER mixer trained in the list of possible mixers.</span>
<span class="sd">    :param seconds_per_encoder: Number of seconds maximum to spend when training an encoder that requires data to \</span>
<span class="sd">    learn a representation.</span>
<span class="sd">    :param expected_additional_time: Time budget for non-encoder/mixer tasks \</span>
<span class="sd">    (ex: data analysis, pre-processing, model ensembling or model analysis)</span>
<span class="sd">    :param time_aim: Time budget (in seconds) to train all needed components for the predictive tasks, including \</span>
<span class="sd">        encoders and models.</span>
<span class="sd">    :param target_weights: indicates to the accuracy functions how much to weight every target class.</span>
<span class="sd">    :param positive_domain: For numerical taks, force predictor output to be positive (integer or float).</span>
<span class="sd">    :param timeseries_settings: TimeseriesSettings object for time-series tasks, refer to its documentation for \</span>
<span class="sd">         available settings.</span>
<span class="sd">    :param anomaly_detection: Whether to conduct unsupervised anomaly detection; currently supported only for time-\</span>
<span class="sd">        series.</span>
<span class="sd">    :param dtype_dict: Mapping of features to types (see `mindsdb.type_infer` for all possible values). This will \</span>
<span class="sd">    override the automated type inference results.</span>
<span class="sd">    :param ignore_features: The names of the columns the user wishes to ignore in the ML pipeline. Any column name \</span>
<span class="sd">        found in this list will be automatically removed from subsequent steps in the ML pipeline.</span>
<span class="sd">    :param use_default_analysis: whether default analysis blocks are enabled.</span>
<span class="sd">    :param fit_on_all: Whether to fit the model on the held-out validation data. Validation data is strictly \</span>
<span class="sd">        used to evaluate how well a model is doing and is NEVER trained. However, in cases where users anticipate new \</span>
<span class="sd">            incoming data over time, the user may train the model further using the entire dataset.</span>
<span class="sd">    :param strict_mode: crash if an `unstable` block (mixer, encoder, etc.) fails to run.</span>
<span class="sd">    :param seed_nr: custom seed to use when generating a predictor from this problem definition.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">target</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">pct_invalid</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">unbias_target</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">seconds_per_mixer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="n">seconds_per_encoder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="n">expected_additional_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="n">time_aim</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
    <span class="n">target_weights</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>
    <span class="n">positive_domain</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">timeseries_settings</span><span class="p">:</span> <span class="n">TimeseriesSettings</span>
    <span class="n">anomaly_detection</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">use_default_analysis</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">embedding_only</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">dtype_dict</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>
    <span class="n">ignore_features</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">fit_on_all</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">strict_mode</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">seed_nr</span><span class="p">:</span> <span class="nb">int</span>

<div class="viewcode-block" id="ProblemDefinition.from_dict"><a class="viewcode-back" href="../../api/types.html#api.types.ProblemDefinition.from_dict">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_dict</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">Dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a ProblemDefinition object from a python dictionary with necessary specifications.</span>

<span class="sd">        :param obj: A python dictionary with the necessary features for the ``ProblemDefinition`` class.</span>
<span class="sd">        Only requires ``target`` to be specified.</span>

<span class="sd">        :returns: A populated ``ProblemDefinition`` object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">target</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
        <span class="n">pct_invalid</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pct_invalid&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">unbias_target</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;unbias_target&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">seconds_per_mixer</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;seconds_per_mixer&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">seconds_per_encoder</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;seconds_per_encoder&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">expected_additional_time</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;expected_additional_time&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="n">time_aim</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;time_aim&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">time_aim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">time_aim</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Your specified time aim of </span><span class="si">{</span><span class="n">time_aim</span><span class="si">}</span><span class="s1"> is too short. Setting it to 10 seconds.&#39;</span><span class="p">)</span>

        <span class="n">target_weights</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;target_weights&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">positive_domain</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;positive_domain&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">dtype_dict</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dtype_dict&#39;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">timeseries_settings</span> <span class="o">=</span> <span class="n">TimeseriesSettings</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;timeseries_settings&#39;</span><span class="p">,</span> <span class="p">{}))</span>
        <span class="n">anomaly_detection</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;anomaly_detection&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">ignore_features</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ignore_features&#39;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">fit_on_all</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fit_on_all&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">use_default_analysis</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;use_default_analysis&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">embedding_only</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;embedding_only&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">strict_mode</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;strict_mode&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">seed_nr</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;seed_nr&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">problem_definition</span> <span class="o">=</span> <span class="n">ProblemDefinition</span><span class="p">(</span>
            <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span>
            <span class="n">pct_invalid</span><span class="o">=</span><span class="n">pct_invalid</span><span class="p">,</span>
            <span class="n">unbias_target</span><span class="o">=</span><span class="n">unbias_target</span><span class="p">,</span>
            <span class="n">seconds_per_mixer</span><span class="o">=</span><span class="n">seconds_per_mixer</span><span class="p">,</span>
            <span class="n">seconds_per_encoder</span><span class="o">=</span><span class="n">seconds_per_encoder</span><span class="p">,</span>
            <span class="n">expected_additional_time</span><span class="o">=</span><span class="n">expected_additional_time</span><span class="p">,</span>
            <span class="n">time_aim</span><span class="o">=</span><span class="n">time_aim</span><span class="p">,</span>
            <span class="n">target_weights</span><span class="o">=</span><span class="n">target_weights</span><span class="p">,</span>
            <span class="n">positive_domain</span><span class="o">=</span><span class="n">positive_domain</span><span class="p">,</span>
            <span class="n">timeseries_settings</span><span class="o">=</span><span class="n">timeseries_settings</span><span class="p">,</span>
            <span class="n">anomaly_detection</span><span class="o">=</span><span class="n">anomaly_detection</span><span class="p">,</span>
            <span class="n">dtype_dict</span><span class="o">=</span><span class="n">dtype_dict</span><span class="p">,</span>
            <span class="n">ignore_features</span><span class="o">=</span><span class="n">ignore_features</span><span class="p">,</span>
            <span class="n">use_default_analysis</span><span class="o">=</span><span class="n">use_default_analysis</span><span class="p">,</span>
            <span class="n">embedding_only</span><span class="o">=</span><span class="n">embedding_only</span><span class="p">,</span>
            <span class="n">fit_on_all</span><span class="o">=</span><span class="n">fit_on_all</span><span class="p">,</span>
            <span class="n">strict_mode</span><span class="o">=</span><span class="n">strict_mode</span><span class="p">,</span>
            <span class="n">seed_nr</span><span class="o">=</span><span class="n">seed_nr</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">problem_definition</span></div>

<div class="viewcode-block" id="ProblemDefinition.from_json"><a class="viewcode-back" href="../../api/types.html#api.types.ProblemDefinition.from_json">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_json</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a ProblemDefinition Object from JSON config file.</span>

<span class="sd">        :param data:</span>

<span class="sd">        :returns: A populated ProblemDefinition object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ProblemDefinition</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">))</span></div>

<div class="viewcode-block" id="ProblemDefinition.to_dict"><a class="viewcode-back" href="../../api/types.html#api.types.ProblemDefinition.to_dict">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encode_json</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Json</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a python dictionary from the ProblemDefinition object</span>

<span class="sd">        :returns: A python dictionary</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_asdict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encode_json</span><span class="o">=</span><span class="n">encode_json</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProblemDefinition.to_json"><a class="viewcode-back" href="../../api/types.html#api.types.ProblemDefinition.to_json">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Json</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a JSON config from the ProblemDefinition object</span>

<span class="sd">        :returns: TODO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span></div></div>


<div class="viewcode-block" id="JsonAI"><a class="viewcode-back" href="../../api/types.html#api.types.JsonAI">[docs]</a><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">JsonAI</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The JsonAI Class allows users to construct flexible JSON config to specify their ML pipeline. JSON-AI follows a \</span>
<span class="sd">    recipe of how to pre-process data, construct features, and train on the target column. To do so, the following \</span>
<span class="sd">    specifications are required internally.</span>

<span class="sd">    :param encoders: A dictionary of the form: `column_name -&gt; encoder module`</span>
<span class="sd">    :param dtype_dict: A dictionary of the form: `column_name -&gt; data type`</span>
<span class="sd">    :param dependency_dict: A dictionary of the form: `column_name -&gt; list of columns it depends on`</span>
<span class="sd">    :param model: The ensemble and its submodels</span>
<span class="sd">    :param problem_definition: The ``ProblemDefinition`` criteria.</span>
<span class="sd">    :param identifiers: A dictionary of column names and respective data types that are likely identifiers/IDs within the data. Through the default cleaning process, these are ignored.</span>
<span class="sd">    :param cleaner: The Cleaner object represents the pre-processing step on a dataframe. The user can specify custom subroutines, if they choose, on how to handle preprocessing. Alternatively, &quot;None&quot; suggests the default approach in ``dataprep_ml.cleaners``.</span>
<span class="sd">    :param splitter: The Splitter object is the method in which the input data is split into training/validation/testing data. For more details, refer to the `dataprep_ml` package documentation.</span>
<span class="sd">    :param analyzer: The Analyzer object is used to evaluate how well a model performed on the predictive task.</span>
<span class="sd">    :param explainer: The Explainer object deploys explainability tools of interest on a model to indicate how well a model generalizes its predictions.</span>
<span class="sd">    :param imputers: A list of objects that will impute missing data on each column. They are called inside the cleaner.</span>
<span class="sd">    :param analysis_blocks: The blocks that get used in both analysis and inference inside the analyzer and explainer blocks.</span>
<span class="sd">    :param timeseries_transformer: Procedure used to transform any timeseries task dataframe into the format that lightwood expects for the rest of the pipeline.  </span>
<span class="sd">    :param timeseries_analyzer: Procedure that extracts key insights from any timeseries in the data (e.g. measurement frequency, target distribution, etc).</span>
<span class="sd">    :param accuracy_functions: A list of performance metrics used to evaluate the best mixers.</span>
<span class="sd">    &quot;&quot;&quot;</span> <span class="c1"># noqa</span>

    <span class="n">encoders</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Module</span><span class="p">]</span>
    <span class="n">dtype_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">dtype</span><span class="p">]</span>
    <span class="n">dependency_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Module</span><span class="p">]</span>
    <span class="n">problem_definition</span><span class="p">:</span> <span class="n">ProblemDefinition</span>
    <span class="n">identifiers</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
    <span class="n">cleaner</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Module</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">splitter</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Module</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">analyzer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Module</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">explainer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Module</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">imputers</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Module</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">analysis_blocks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Module</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">timeseries_transformer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Module</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">timeseries_analyzer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Module</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">accuracy_functions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Module</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="JsonAI.from_dict"><a class="viewcode-back" href="../../api/types.html#api.types.JsonAI.from_dict">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_dict</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">Dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a JSON-AI object from dictionary specifications of the JSON-config.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">encoders</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;encoders&quot;</span><span class="p">]</span>
        <span class="n">dtype_dict</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;dtype_dict&quot;</span><span class="p">]</span>
        <span class="n">dependency_dict</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;dependency_dict&quot;</span><span class="p">]</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">]</span>
        <span class="n">problem_definition</span> <span class="o">=</span> <span class="n">ProblemDefinition</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="s2">&quot;problem_definition&quot;</span><span class="p">])</span>
        <span class="n">identifiers</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;identifiers&quot;</span><span class="p">]</span>
        <span class="n">cleaner</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;cleaner&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">splitter</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;splitter&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">analyzer</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;analyzer&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">explainer</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;explainer&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">imputers</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;imputers&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">analysis_blocks</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;analysis_blocks&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">timeseries_transformer</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;timeseries_transformer&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">timeseries_analyzer</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;timeseries_analyzer&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">accuracy_functions</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;accuracy_functions&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="n">json_ai</span> <span class="o">=</span> <span class="n">JsonAI</span><span class="p">(</span>
            <span class="n">encoders</span><span class="o">=</span><span class="n">encoders</span><span class="p">,</span>
            <span class="n">dtype_dict</span><span class="o">=</span><span class="n">dtype_dict</span><span class="p">,</span>
            <span class="n">dependency_dict</span><span class="o">=</span><span class="n">dependency_dict</span><span class="p">,</span>
            <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
            <span class="n">problem_definition</span><span class="o">=</span><span class="n">problem_definition</span><span class="p">,</span>
            <span class="n">identifiers</span><span class="o">=</span><span class="n">identifiers</span><span class="p">,</span>
            <span class="n">cleaner</span><span class="o">=</span><span class="n">cleaner</span><span class="p">,</span>
            <span class="n">splitter</span><span class="o">=</span><span class="n">splitter</span><span class="p">,</span>
            <span class="n">analyzer</span><span class="o">=</span><span class="n">analyzer</span><span class="p">,</span>
            <span class="n">explainer</span><span class="o">=</span><span class="n">explainer</span><span class="p">,</span>
            <span class="n">imputers</span><span class="o">=</span><span class="n">imputers</span><span class="p">,</span>
            <span class="n">analysis_blocks</span><span class="o">=</span><span class="n">analysis_blocks</span><span class="p">,</span>
            <span class="n">timeseries_transformer</span><span class="o">=</span><span class="n">timeseries_transformer</span><span class="p">,</span>
            <span class="n">timeseries_analyzer</span><span class="o">=</span><span class="n">timeseries_analyzer</span><span class="p">,</span>
            <span class="n">accuracy_functions</span><span class="o">=</span><span class="n">accuracy_functions</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">json_ai</span></div>

<div class="viewcode-block" id="JsonAI.from_json"><a class="viewcode-back" href="../../api/types.html#api.types.JsonAI.from_json">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_json</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Creates a JSON-AI object from JSON config&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">JsonAI</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">))</span></div>

<div class="viewcode-block" id="JsonAI.to_dict"><a class="viewcode-back" href="../../api/types.html#api.types.JsonAI.to_dict">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encode_json</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Json</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a python dictionary with necessary modules within the ML pipeline specified from the JSON-AI object.</span>

<span class="sd">        :returns: A python dictionary that has the necessary components of the ML pipeline for a given dataset.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">as_dict</span> <span class="o">=</span> <span class="n">_asdict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encode_json</span><span class="o">=</span><span class="n">encode_json</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">as_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;features&quot;</span><span class="p">:</span>
                <span class="n">feature_dict</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">features</span><span class="p">:</span>
                    <span class="n">feature_dict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">features</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
                <span class="n">as_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">feature_dict</span>
            <span class="k">if</span> <span class="n">as_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">as_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">as_dict</span></div>

<div class="viewcode-block" id="JsonAI.to_json"><a class="viewcode-back" href="../../api/types.html#api.types.JsonAI.to_json">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Json</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates JSON config to represent the necessary modules within the ML pipeline specified from the JSON-AI object.</span>

<span class="sd">        :returns: A JSON config that has the necessary components of the ML pipeline for a given dataset.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="SubmodelData"><a class="viewcode-back" href="../../api/types.html#api.types.SubmodelData">[docs]</a><span class="nd">@dataclass_json</span>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SubmodelData</span><span class="p">:</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">accuracy</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">is_best</span><span class="p">:</span> <span class="nb">bool</span></div>


<div class="viewcode-block" id="ModelAnalysis"><a class="viewcode-back" href="../../api/types.html#api.types.ModelAnalysis">[docs]</a><span class="nd">@dataclass_json</span>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ModelAnalysis</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The ``ModelAnalysis`` class stores useful information to describe a model and understand its predictive performance on a validation dataset.</span>
<span class="sd">    For each trained ML algorithm, we store:</span>

<span class="sd">    :param accuracies: Dictionary with obtained values for each accuracy function (specified in JsonAI)</span>
<span class="sd">    :param accuracy_histogram: Dictionary with histograms of reported accuracy by target value.</span>
<span class="sd">    :param accuracy_samples: Dictionary with sampled pairs of observed target values and respective predictions.</span>
<span class="sd">    :param train_sample_size: Size of the training set (data that parameters are updated on)</span>
<span class="sd">    :param test_sample_size: Size of the testing set (explicitly held out)</span>
<span class="sd">    :param column_importances: Dictionary with the importance of each column for the model, as estimated by an approach that closely follows a leave-one-covariate-out strategy.</span>
<span class="sd">    :param confusion_matrix: A confusion matrix for the validation dataset.</span>
<span class="sd">    :param histograms: Histogram for each dataset feature.</span>
<span class="sd">    :param dtypes: Inferred data types for each dataset feature.</span>

<span class="sd">    &quot;&quot;&quot;</span> <span class="c1"># noqa</span>

    <span class="n">accuracies</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
    <span class="n">accuracy_histogram</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span>
    <span class="n">accuracy_samples</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span>
    <span class="n">train_sample_size</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">test_sample_size</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">column_importances</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
    <span class="n">confusion_matrix</span><span class="p">:</span> <span class="nb">object</span>
    <span class="n">histograms</span><span class="p">:</span> <span class="nb">object</span>
    <span class="n">dtypes</span><span class="p">:</span> <span class="nb">object</span>
    <span class="n">submodel_data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">SubmodelData</span><span class="p">]</span></div>


<div class="viewcode-block" id="PredictionArguments"><a class="viewcode-back" href="../../api/types.html#api.types.PredictionArguments">[docs]</a><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">PredictionArguments</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class contains all possible arguments that can be passed to a Lightwood predictor at inference time.</span>
<span class="sd">    On each predict call, all arguments included in a parameter dictionary will update the respective fields</span>
<span class="sd">    in the `PredictionArguments` instance that the predictor will have.</span>
<span class="sd">    </span>
<span class="sd">    :param predict_proba: triggers (where supported) predictions in raw probability output form. I.e. for classifiers,</span>
<span class="sd">    instead of returning only the predicted class, the output additionally includes the assigned probability for</span>
<span class="sd">    each class.   </span>
<span class="sd">    :param all_mixers: forces an ensemble to return predictions emitted by all its internal mixers.</span>
<span class="sd">    :param mixer_weights: a list with coefficients that are normalized into 0-1 bounded scores to mix the output of all mixers available to a compatible ensemble (e.g. [0.5, 0.5] for an ensemble with two mixers would yield the mean prediction). Can be used with WeightedMeanEnsemble, StackedEnsemble or TsStackedEnsemble.</span>
<span class="sd">    :param fixed_confidence: Used in the ICP analyzer module, specifies an `alpha` fixed confidence so that predictions, in average, are correct `alpha` percent of the time. For unsupervised anomaly detection, this also translates into the expected error rate. Bounded between 0.01 and 0.99 (respectively implies wider and tighter bounds, all other parameters being equal).</span>
<span class="sd">    :param anomaly_cooldown: Sets the minimum amount of timesteps between consecutive firings of the the anomaly detector.</span>
<span class="sd">    :param simple_ts_bounds: in forecasting contexts, enabling this parameter disables the usual conformal-based bounds (with Bonferroni correction) and resorts to a simpler way of scaling bounds through the horizon based on the uncertainty estimation for the first value in the forecast (see helpers.ts.add_tn_num_conf_bounds for the implementation).</span>
<span class="sd">    :param anomaly_cooldown: Sets the minimum amount of timesteps between consecutive firings of the the anomaly \</span>
<span class="sd">        detector.</span>
<span class="sd">    :param time_format: For time series predictors. If set to `infer`, predicted `order_by` timestamps will be formatted back to the original dataset&#39;s `order_by` format. Any other string value will be used as a formatting string, unless empty (&#39;&#39;), which disables the feature (this is the default behavior).</span>
<span class="sd">    :param force_ts_infer: For time series predictors. If set to `true`, an additional row will be produced per each group in the input DF, corresponding to an out-of-sample forecast w.r.t. to the input timestamps.</span>
<span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># noqa</span>

    <span class="n">predict_proba</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">all_mixers</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">mixer_weights</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">fixed_confidence</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">anomaly_cooldown</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">forecast_offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">simple_ts_bounds</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">time_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">force_ts_infer</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">return_embedding</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>

<div class="viewcode-block" id="PredictionArguments.from_dict"><a class="viewcode-back" href="../../api/types.html#api.types.PredictionArguments.from_dict">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_dict</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">Dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a ``PredictionArguments`` object from a python dictionary with necessary specifications.</span>

<span class="sd">        :param obj: A python dictionary with the necessary features for the ``PredictionArguments`` class.</span>

<span class="sd">        :returns: A populated ``PredictionArguments`` object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># maybe this should be stateful instead, and save the latest used value for each field?</span>
        <span class="n">predict_proba</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;predict_proba&#39;</span><span class="p">,</span> <span class="n">PredictionArguments</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">)</span>
        <span class="n">all_mixers</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;all_mixers&#39;</span><span class="p">,</span> <span class="n">PredictionArguments</span><span class="o">.</span><span class="n">all_mixers</span><span class="p">)</span>
        <span class="n">mixer_weights</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mixer_weights&#39;</span><span class="p">,</span> <span class="n">PredictionArguments</span><span class="o">.</span><span class="n">mixer_weights</span><span class="p">)</span>
        <span class="n">fixed_confidence</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fixed_confidence&#39;</span><span class="p">,</span> <span class="n">PredictionArguments</span><span class="o">.</span><span class="n">fixed_confidence</span><span class="p">)</span>
        <span class="n">anomaly_cooldown</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;anomaly_cooldown&#39;</span><span class="p">,</span> <span class="n">PredictionArguments</span><span class="o">.</span><span class="n">anomaly_cooldown</span><span class="p">)</span>
        <span class="n">forecast_offset</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;forecast_offset&#39;</span><span class="p">,</span> <span class="n">PredictionArguments</span><span class="o">.</span><span class="n">forecast_offset</span><span class="p">)</span>
        <span class="n">simple_ts_bounds</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;simple_ts_bounds&#39;</span><span class="p">,</span> <span class="n">PredictionArguments</span><span class="o">.</span><span class="n">simple_ts_bounds</span><span class="p">)</span>
        <span class="n">time_format</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;time_format&#39;</span><span class="p">,</span> <span class="n">PredictionArguments</span><span class="o">.</span><span class="n">time_format</span><span class="p">)</span>
        <span class="n">force_ts_infer</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;force_ts_infer&#39;</span><span class="p">,</span> <span class="n">PredictionArguments</span><span class="o">.</span><span class="n">force_ts_infer</span><span class="p">)</span>
        <span class="n">return_embedding</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;return_embedding&#39;</span><span class="p">,</span> <span class="n">PredictionArguments</span><span class="o">.</span><span class="n">return_embedding</span><span class="p">)</span>

        <span class="n">pred_args</span> <span class="o">=</span> <span class="n">PredictionArguments</span><span class="p">(</span>
            <span class="n">predict_proba</span><span class="o">=</span><span class="n">predict_proba</span><span class="p">,</span>
            <span class="n">all_mixers</span><span class="o">=</span><span class="n">all_mixers</span><span class="p">,</span>
            <span class="n">mixer_weights</span><span class="o">=</span><span class="n">mixer_weights</span><span class="p">,</span>
            <span class="n">fixed_confidence</span><span class="o">=</span><span class="n">fixed_confidence</span><span class="p">,</span>
            <span class="n">anomaly_cooldown</span><span class="o">=</span><span class="n">anomaly_cooldown</span><span class="p">,</span>
            <span class="n">forecast_offset</span><span class="o">=</span><span class="n">forecast_offset</span><span class="p">,</span>
            <span class="n">simple_ts_bounds</span><span class="o">=</span><span class="n">simple_ts_bounds</span><span class="p">,</span>
            <span class="n">time_format</span><span class="o">=</span><span class="n">time_format</span><span class="p">,</span>
            <span class="n">force_ts_infer</span><span class="o">=</span><span class="n">force_ts_infer</span><span class="p">,</span>
            <span class="n">return_embedding</span><span class="o">=</span><span class="n">return_embedding</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">pred_args</span></div>

<div class="viewcode-block" id="PredictionArguments.to_dict"><a class="viewcode-back" href="../../api/types.html#api.types.PredictionArguments.to_dict">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encode_json</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Json</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a python dictionary from the ``PredictionArguments`` object</span>

<span class="sd">        :returns: A python dictionary</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_asdict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encode_json</span><span class="o">=</span><span class="n">encode_json</span><span class="p">)</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017-2025, MindsDB.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>